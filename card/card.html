<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>카드</title>
    <link rel="stylesheet" href="./card.css" />
</head>
<body>
    <!-- 
        [카드 맞추기]
        카드가 12장 있고, 2장씩 서로 앞면의 색 동일.
        게임이 시작되면 카드를 무작위로 섞어 배치한 뒤에 모든 카드의 앞면을 잠깐 표시.
        일정 시간 후에 카드가 모두 뒷면으로 돌아가면 카드를 2장씩 뒤집으며 확인.
        카드 12장을 모두 뒤집을 때까지 계속하고 카드의 짝을 모두 맞추면 끝.
     -->
    <div class="wrap">
        <div id="" data-value="1" class="card">
            <div class="card_front">앞면</div>
            <div class="card_back">뒷면</div>
        </div>
        <div id="" data-value="" class="card ">
            <div class="card_front">앞면</div>
            <div class="card_back">뒷면</div>
        </div>
        <div id="" data-value="" class="card ">
            <div class="card_front">앞면</div>
            <div class="card_back">뒷면</div>
        </div>
        <div id="" data-value="" class="card ">
            <div class="card_front">앞면</div>
            <div class="card_back">뒷면</div>
        </div>
    </div>

    <!-- 딤 레이어 -->
    <div class="ly_pop ">
        <div class="txt">
            잠시 후 카드의 앞면을 볼 수 있습니다. <br>
            짝 맞추기 게임입니다. <br> 카드의 색상의 위치를 외워주세요.<br>
            카드의 앞면이 3초간 보였다가 닫힙니다.<br><br>
            <span class="txt_count">3</span>
        </div>
        <div class="dimm"></div>
    </div>

    <script>
        const cardList = document.querySelectorAll('.wrap .card'); // 카드요소
        const cardEndArr = []; // 완료카드
        const cardChoiceArr = []; // 뒤집힌카드 - 선택된 카드
        let cardColorArr = ['red', 'blue', 'red', 'blue']; // 색상코드

        // 뒷면이 처음에 보인다.
        // 게임이 시작되면 카드를 무작위로 섞어 배치

        // 색상코드를 빼서 element 순서대로 색상 대입
        // data-value , class 명에 대입
        //cardList.setAttribute["data", "helloButton"];

        // 클래스 담아야함!!!! data-value에 담았듯이
        if (cardList.length !== cardColorArr.length) {
            console.error("카드 리스트의 길이와 색상 배열의 길이가 맞지 않습니다.");
        } else {
            // 게임이 시작되면 카드를 무작위로 섞어 배치
            for(let i = 0; i < cardList.length; i++){
                // 무작위 인덱스 선택
                const deletedIndex = Math.floor(Math.random() * cardColorArr.length);
                
                // 선택된 색상을 data-value에 설정
                cardList[i].setAttribute('data-value', cardColorArr[deletedIndex]);

                // 선택된 색상을 class에 설정
                cardList[i].classList.add(cardColorArr[deletedIndex]);
                
                // 사용된 색상을 배열에서 제거
                cardColorArr.splice(deletedIndex, 1);
            }
        }

        const lyPopEl = document.querySelector('.ly_pop');
        lyPopEl.classList.add('active');

        // 2초 후 시작
        let count = 2;

        const countdown = setInterval(function() {
            let countEl = document.querySelector('.txt_count');
            countEl.textContent = count;
            count--;

            if (count < 0) {
                clearInterval(countdown);
                lyPopEl.classList.remove('active');
            }
        }, 1000);

        // 모든 카드의 앞면을 잠깐 표시
        setTimeout(() => {
            // 함수 실행
            init();
        }, 3000)
        

        const init = () => {
            // 팝업 닫기
            const lyPopEl = document.querySelector('.ly_pop');
            lyPopEl.classList.remove('active');

            // 앞면을 보여줌
            // flipped 클래스명을 추가
            const wrapEl = document.querySelector('.wrap');
            wrapEl.classList.add('flipped');
            setTimeout(() => {
                wrapEl.classList.remove('flipped');
                wrapEl.classList.add('active');
            }, 3000)
        }
    </script>
</body>
</html>