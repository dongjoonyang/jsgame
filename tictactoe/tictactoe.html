<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tictactoe</title>
    <style>
        table {
            border-collapse: collapse;
        }
        td {
            border: 1px solid black;
            width: 40px;
            height: 40px;
            text-align: center;
        }
    </style>
</head>
<body>
    <!-- 
        틱택토(tic-tac-toe) 게임은 오목의 축소판인 삼목 
        삼목은 바둑판이 아니라 3 × 3 표 위에서 진행
        표와 같은 삼목 데이터는 자바스크립트에서 이차원 배열로 표현
        틱택토를 만들면서 이차원 배열로 데이터를 관리하고, 
        배열 데이터를 HTML 화면에 그대로 표시하는 작업

        틱택토는 O와 X로 표시
        혼자 번갈아 가며 O와 X를 그림
        
        // 여기서 부터 진행 
        번갈아 가며 칸을 채운 뒤 승자를 판단.
        가로줄이나 세로줄, 대각선에 같은 모양이 오면 승리.
        승자가 가려졌다면 누가 승자인지는 div 태그를 만들어 표시.
        만약 9칸을 다 채웠는데 승자가 없다면 무승부라는 메시지를 표시.
        먼저 승자인지를 판단하는 checkWinner 함수를 생성.
     -->

     <!-- <table>
        <tr>
          <td id="td00"></td>
          <td id="td01">X</td>
          <td id="td02"></td>
        </tr>
        <tr>
          <td id="td10">O</td>
          <td id="td11"></td>
          <td id="td12">O</td>
        </tr>
        <tr>
          <td id="td20"></td>
          <td id="td21">O</td>
          <td id="td22">X</td>
        </tr>
      </table> -->
    <script>
        const { body } = document;
        const $table = document.createElement('table');
        const $result = document.createElement('div'); // 결과창
        const rows = [];
        let turn = 'O';

        const callback = (event) => {
            if(event.target.textContent !== ""){
                console.log('빈칸이 아닙니다.');
            } else {
                console.log('빈칸 입니다.');
                event.target.textContent = turn;
                turn = turn === 'X' ? 'O' : 'X';
            }

            const hasWinner = checkWinner(event.target);
            // 승자가 있으면
            if (hasWinner) {
                $result.textContent = `${turn}님이 승리!`;
                $table.removeEventListener('click', callback);
                return;
            }
        }
        
        for (let i = 1; i <= 3; i += 1) {
            const $tr = document.createElement('tr');
            const cells = [];
            for (let j = 1; j <= 3; j += 1) {
                const $td = document.createElement('td');
                cells.push($td);
                $tr.appendChild($td);
            }
            rows.push(cells);
            $table.appendChild($tr);
        }


        const checkWinner = (target) => {
            let rowIndex;
            let cellIndex;
            rows.forEach((row, ri) => { // 배열 rows   [td],[td],[td]  ri = 0
                                        //            [td],[td],[td]  ri = 1
                                        //            [td],[td],[td]  ri = 2
                row.forEach((cell, ci) => { // ci
                                            // [td],[td],[td] ri = 0   /   0, 1, 2 
                                            // [td],[td],[td] ri = 0   /   0, 1, 2 
                                            // [td],[td],[td] ri = 0   /   0, 1, 2 
                                            // 오로지 ci는 0, 1, 2를 가지고 있을 뿐

                                            // cell
                                            // 오로지 td를 가질 뿐임.  
                    if (cell === target) {  // ex) [0][1] 의 cell을 클릭했다고 하면 
                                            // [0][0] 째 cell === target 은 아래처럼 false 
                                            // <td></td>  : cell 첫번째
                                            // <td>0</td> : target       false
                                            // <td>0</td>  : cell 두번째
                                            // <td>0</td>  : taret       true 가 됨
                        rowIndex = ri;      // 그러면 첫번째 반복문은 row가 ri = 0 
                        cellIndex = ci;     // ci는 1이 됨
                    }
                });
            });

            let hasWinner = false;

            // 가로줄 검사
            if (
                rows[rowIndex][0].textContent === turn &&
                rows[rowIndex][1].textContent === turn &&
                rows[rowIndex][2].textContent === turn
            ) {
                hasWinner = true;
            }
            // 세로줄 검사
            if (
                rows[0][cellIndex].textContent   === turn &&
                rows[1][cellIndex].textContent === turn &&
                rows[2][cellIndex].textContent === turn
            ) {
                hasWinner = true;
            }
            // 대각선 검사
            if (
                rows[0][0].textContent === turn &&
                rows[1][1].textContent === turn &&
                rows[2][2].textContent === turn
            ) {
                hasWinner = true;
            }
            if (
                rows[0][2].textContent === turn &&
                rows[1][1].textContent === turn &&
                rows[2][0].textContent === turn
            ) {
                hasWinner = true;
            }
            return hasWinner;
        }

        $table.addEventListener('click', callback);
        body.appendChild($table);
        
        body.appendChild($result);
    </script>
</body>
</html>



